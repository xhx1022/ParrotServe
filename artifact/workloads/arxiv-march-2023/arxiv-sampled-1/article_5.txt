
firstpagehf
Classification of blazar candidates of unknown type in Fermi 4LAC by unanimous voting from multiple Machine Learning Algorithms
    [
    Accepted xxxx xxxxxx xx. Received xxxx xxxxxx xx; in original form xxxx xxx xx
===============================================================================================================================




In the past decade, Artificial Intelligence (AI) algorithms have made promising impacts to transform healthcare in all aspects. One application is to triage patients’ radiological medical images based on the algorithm's binary outputs. Such AI-based prioritization software is known as computer-aided triage and notification (CADt). Their main benefit is to speed up radiological review of images with time-sensitive findings. However, as CADt devices become more common in clinical workflows, there is still a lack of quantitative methods to evaluate a device’s effectiveness in saving patients' waiting times. In this paper, we present a mathematical framework based on queueing theory to calculate the average waiting time per patient image before and after a CADt device is used. We study four workflow models with multiple radiologists (servers) and priority classes for a range of AI diagnostic performance, radiologist's reading rates, and patient image (customer) arrival rates. Due to model complexity, an approximation method known as the Recursive Dimensionality Reduction technique is applied. We define a performance metric to measure the device’s time-saving effectiveness. A software tool is developed to simulate clinical workflow of image review/interpretation, to verify theoretical results, and to provide confidence intervals  of the performance metric we defined. It is shown quantitatively that a triage device is more effective in a busy, short-staffed setting, which is consistent with our clinical intuition and simulation results. Although this work is motivated by the need for evaluating CADt devices, the framework we present in this paper can be applied to any algorithm that prioritizes customers based on its binary outputs.    







§ INTRODUCTION



The fast-growing development of artificial intelligence (AI) and machine learning (ML) technologies bring a potential to transform healthcare in many ways.
One emerging area is the use of AI/ML as Software as a Medical Device (SaMD) in radiological imaging to triage patient images with time-sensitive findings for image interpretation <cit.>.
These devices are known as computer-aided triage and notification (CADt) devices, by which medical images labeled as positive by an AI algorithm are prioritized in the radiologist's reading queue.
The major benefit of a CADt device is to increase the likelihood of timely diagnosis and treatment of severe and time-critical diseases such as large vessel occlusion (LVO), intracranial hemorrhage (ICH), pneumothorax, etc.
In 2018, the U.S. Food and Drug Administration (FDA) granted marketing authorization to the first CADt device for potential LVO stroke patients via the de novo pathway <cit.>. 
Since then, multiple studies have shown improvements in patient treatment and clinical outcomes due to the use of CADt devices <cit.>.
Most of these analyses focus on the diagnostic performance when evaluating these CADt devices, but a quantitative estimate of time savings for truly diseased (signal-present) patient images in a clinical environment remain unclear.
Therefore, the goal of this work is to fill this gap by developing a queueing-theory based tool to characterize the time-saving effectiveness of a CADt device in a given clinical setting.

Figure <ref> illustrates the radiologist workflows without and with a CADt device being used.
In the standard of care without a CADt device, patient images are reviewed by a radiologist on a first-in, first-out (FIFO) basis.
In the context of queuing theory, our servers are radiologists, and our customers are patient images.
Occasionally, the radiologist may be interrupted by an emergent case, for example, when a physician requests an immediate review of a specific patient image.
To distinguish these emergent cases from those in the reading queue, we call the images in the reading list “non-emergent."
If a CADt device is included in the workflow, the device only analyzes non-emergent patient images.

Cases labeled as AI-positive are either flagged or moved up in a radiologist's reading list, giving them higher priority, and the radiologist will review those cases before all AI-negative patient images.
Just like the without-CADt scenario, the radiologist may be interrupted by emergent cases, which always have the highest priority over other images.
Overall, without a CADt, we have a queue with two priority classes, and we have a queue with three priority classes in a with-CADt scenario.



It is noted that, though applied to radiology clinics, the mathematical frameworks presented here could be used to evaluate discrimination algorithms in other queueing contexts.
For example, algorithms may attempt to identify customers or jobs who may require less service time and place them into a higher priority class, thereby reducing overall wait time for customers on average.






§ PARAMETERS



Before applying queueing theory, a few parameters are defined to describe the clinical setting.

  
  * f_em is the fraction of emergent patient images with respect to all patient images.
  
  * λ is the Poisson arrival rate of all patient images.
  Patient images can be divided into subgroups, and each subgroup i has a Poisson arrival rate λ_i = p_iλ, where p_i is the fraction of image subgroup i with respect to all patient images.
  
  * The disease prevalence π is defined within the non-emergent patient population, i.e.
  
    π = Number of diseased, non-emergent cases/Number of non-emergent cases.

  
  * CADt diagnostic performance is defined by its sensitivity (Se) and specificity (Sp), which are also defined within the non-emergent patient images i.e.
  
    Se = 0.85Number of AI-positive, diseased, non-emergent cases/Number of diseased, non-emergent cases,

  and
  
    0.85Sp = Number of AI-negative, non-diseased, non-emergent cases/Number of non-diseased, non-emergent cases.

  
  * N_rad is the number of radiologists on-site.
  Typically, a clinic has at least one radiologist at all times. 
  For a larger hospital, multiple radiologists may be available during the day.
  
  * The radiologist's reading rates are denoted by μ's.
  For emergent (highest-priority) cases, the reading time T_em is assumed to be exponentially distributed with an average reading rate μ_em=1/T_em.
  For a non-emergent image, the average reading rate depends on the radiologist's diagnosis i.e. μ_D if diseased image or μ_ND if non-diseased image.
  Therefore, in the without-CADt scenario, the reading time of the non-emergent (lower-priority) cases follows a hyperexponential distribution where the mean (1/μ_nonEm) is determined by the mean reading rates of the two subgroups and the probability of disease prevalence π.
  
    1/μ_nonEm = π/μ_D + 1-π/μ_ND.

  In the with-CADt scenario, the average reading rates for AI-positive (middle-priority) and AI-negative (lowest-priority) classes are denoted by μ_+ and μ_- respectively.
  The AI-positive group consists of true-positive (TP) and false-positive (FP) patients, and the probability that an AI-positive case is a TP is defined by the positive predictive value (PPV).
  Hence, 
  
    1/μ_+ = PPV/μ_D + 1-PPV/μ_ND.
  
  Similarly, the average AI-negative reading rate is given by
  
    1/μ_- = 1-NPV/μ_D + NPV/μ_ND,
  
  where NPV is the probability that an AI-negative case is a true-negative (TN).
  
  * ρ is the traffic intensity defined as ρ = λ/μ_eff, where  μ_eff is effective reading rate considering all priority classes and N_rad in the queueing system.
  ρ ranges from 0 with no patient images arriving to 1 implying a very congested hospital.
  
  * With regard to the queueing discipline, when no CADt device is used, patient images are read in the order of their arrival time i.e. first-in first-out (FIFO).
  In the with-CADt scenario, we consider a preemptive-resume priority scheduling:
  whether or not a CADt device is used, whenever a higher-priority patient image enters the system, the reading of a lower-priority patient image will be interrupted and later resumed.
  Although in reality some radiologists may prefer finishing up the current lower-priority image when a CADt device flags a higher-priority case (which would be a non-preemptive-resume priority), many CADt devices are designed assuming a radiologist reads the flagged cases immediately.
  Therefore, a preemptive-resume priority is assumed in this work.


To assess the time-saving effectiveness of a given CADt device in a clinical setting defined by the above parameters, we first define four radiologist workflow models in Section <ref>. 
For each of the models, we provide the Markov chain matrices to compute the mean waiting time for each priority class in both with- and without-CADt scenarios.
Section <ref> discusses an in-house simulation software developed to verify theoretical results and to provide confidence intervals around the theoretical mean time savings.
Section <ref> defines a metric that quantifies the time-saving effectiveness of a CADt device, and Section <ref> discusses the results obtained from theory and simulation.






§ RADIOLOGIST WORKFLOW MODELS



We consider four radiologist workflow models:

    
  * Model A: The baseline model (N_rad = 1, f_em = 0, and μ_D = μ_ND)
    
  * Model B: Model A but with emergent patient images (N_rad = 1, f_em > 0, and μ_D = μ_ND)
    
  * Model C: Model B but with two radiologists  (N_rad = 2, f_em > 0, and μ_D = μ_ND)
    
  * Model D: Model B but with different reading rates for diseased and non-diseased images (N_rad = 1, f_em > 0, and μ_D ≠μ_ND)


For each model, two calculations are performed: one assumes a without-CADt scenario, and the other assumes the use of a CADt device.
Each scenario has a set of states that keeps track of the numbers of patient images in different priority classes.
The transition rates among states form a stochastic Markov chain matrix, from which the matrix geometric method is applied to calculate the set of state probabilities <cit.> .
For models involving multiple radiologists and priority classes, we apply the Recursive Dimensionality Reduction (RDR) method proposed by <cit.> to facilitate the calculation.
Little's Law <cit.> is then applied to calculate the mean waiting time per patient image for each priority class involved.






 §.§ Model A: Baseline model


We start with a simple model with the absence of emergent patient images (f_em = 0), one radiologist on-site (N_rad = 1), and identical reading rates for diseased and non-diseased subgroups (μ_D = μ_ND).



  §.§.§ Model A in without-CADt scenario





First, we consider the without-CADt scenario.
Given that f_em = 0, only one priority class (the non-emergent subgroup) exists, and the arrival rate λ is the arrival rate of non-emergent patient images λ_nonEm.
When μ_D = μ_ND and with only 1 radiologist on-site, the effective reading rate for the non-emergent subgroup is μ_nonEm = μ_D = μ_ND.
Hence, Model A turns into a classic M/M/1/FIFO queueing model <cit.>.
Its transition diagram is shown in Figure <ref>, from which the state probability p_n is given by

    p_n_nonEm = ρ_nonEm^n (1-ρ_nonEm),

where n_nonEm denotes the number of non-emergent patient image in the system.
From the state probability p_n_nonEm, the average waiting time per non-emergent patient image can be calculated by the following steps.

  
  * Calculate the average number of non-emergent patient images in the system, L, from the state probability p_n_nonEm. That is, L =⟨ p_n_nonEm⟩, where ⟨⟩ is the expectation operator.
  
  * Calculate the average response time per non-emergent patient image, W, via Little's Law i.e. W = L/λ_nonEm.
  
  * Calculate the average waiting time in the queue per non-emergent patient, W_q_nonEm.
  Because W is the sum of W_q_nonEm and the mean radiologist's reading time T=1/μ_nonEm, we have W_q_nonEm  = W - 1/μ_nonEm.

In summary, the average waiting time per non-emergent patient image W_q_nonEm in a without-CADt scenario is given by

    W_q_nonEm = ⟨ p_n_nonEm⟩/λ_nonEm - 1/μ_nonEm.




  §.§.§ Model A in with-CADt scenario



When a CADt-device is used with no emergent patient images (f_em = 0), two priority classes exist: an AI-positive, higher-priority class and an AI-negative, lower-priority class.
The arrival rates of AI-positive and AI-negative classes depend on the CADt diagnostic performance.

    λ_+ = [πSe + (1-π)(1-Sp) ]λ,


    λ_- = [π(1-Se) + (1-π)Sp]λ.

The state of a two-priority class system is defined by the number of AI-positive cases n_+ and that of AI-negative n_-.
As shown in Figure <ref>, the exact transition diagram is infinite in both horizontal (n_-) and vertical (n_+) directions.
With an assumed preemptive-resume priority scheduling, this 2D-infinity problem can be resolved using the Recursive Dimensionality Reduction (RDR) method <cit.>, in which the tangled two-priority-class system is broken down into two independent calculations, one for each priority class.



First, we focus on the AI-positive, higher-priority system.
Because of the preemptive-resume queueing discipline, the AI-positive subgroup is not affected by the AI-negative images at all and is, by itself, a classic M/M/1/FIFO queueing model.
Therefore, to solve for the average waiting time per AI-positive patient image, one can reuse Figure <ref> and replace n_nonEm by n_+.
The state probability for AI-positive patient images is modified based on Equation <ref>; 

    p_n_+ = ρ_+^n_+ (1-ρ_+),

where ρ_+ ≡λ_+/μ_+ is the traffic intensity for the AI-positive subgroup only.
Following the steps in Equation <ref>, the average waiting time per AI-positive patient image W_q_+ is given by

    W_q_+ = ⟨ p_n_+⟩/λ_+ - 1/μ_+.


For the calculation of the AI-negative, lower-priority class, we cannot ignore the presence of AI-positive cases.
However, with only one radiologist, no AI-negative patient image can exit the system when n_+ ≥ 1.
As noted by <cit.>, there is no need to keep track of every state beyond n_+ ≥ 1.
Hence, every column in Figure <ref> can be truncated such that all states beyond n_+ ≥ 1 are represented by (1^+, n_-).
The RDR-truncated transition diagram is shown in Figure <ref>.



Because of the truncation, the transition rate B from (1_+, n_-) to (0, n_-) no longer represents a simple exponential transition time distribution.
In fact, the shape of this transition time distribution is often unknown but can be approximated to an Erlang-Coxian (EC) distribution.
As shown in Figure <ref>, a general EC distribution consists of exactly two Coxian phases and N__EC-2 Erlang phases.
For a given distribution of unknown shape, <cit.> provided closed-form solutions to calculate the first three moments of the unknown distribution and the six parameters in the EC distribution that best matches the first three moments. 



When applying the EC-approximation method to the RDR-truncated transition diagram in Figure <ref>, only the two-phase Coxian distribution is sufficient.
No Erlang phases are needed; hence, p__EC, N__EC, and λ_Y_EC in Figure <ref> are 1, 2, and 0 respectively.
The non-exponential transition B can then be explicitly expressed in terms of the approximated exponential transition rates t's as shown in Figure <ref>, where

    t_1     = (1-p_X_EC)λ_X1_EC; 
    t_12 = p_X_ECλ_X1_EC; 
    t_2 = λ_X2_EC.




Figure <ref> is a typical Markov chain transition diagram, and its transition rate matrix M_A can be formed (see Section <ref> in Electronic Companions).
Using the matrix geometric method, an analysis method for quasi-birth–death processes where the Markov chain matrix has a repetitive block structure <cit.>, the state probability p_n_- is computed.
Hence, the average waiting time per AI-negative, low-priority patient image, W_q_-, can be calculated;

    W_q_- = ⟨ p_n_-⟩/λ_- - 1/μ_-.







 §.§ Model B: Model A with emergent patient images



Model B is similar to Model A but with the presence of emergent patient images (f_em > 0).
These emergent images are prioritized to the highest priority regardless of the presence of CADt devices.
Although the waiting time of the emergent subgroup can be studied, this work only focuses on the non-emergent, AI-positive, and AI-negative subgroups which are impacted by the CADt device.



  §.§.§ Model B in without-CADt scenario



In the standard of care without a CADt device, the presence of emergent class results in a two-priority-class queueing system: emergent and non-emergent classes.
For the emergent subgroup, μ_em denotes its radiologist's reading rate, and its arrival rate is given by

    λ_em = f_emλ.

The arrival rate for the non-emergent class is 

    λ_nonEm = (1-f_em)λ.

Similar to Model A, because μ_D = μ_ND and N_rad = 1, the effective reading rate for the non-emergent subgroup is μ_nonEm =μ_D = μ_ND.

With only one radiologist on-site, the analysis of non-emergent, lower-priority class is exactly the same as that of the AI-negative class in Model A in the with-CADt scenario.
Figure <ref> (and Equation <ref> in Electronic Companions) can be reused by replacing λ_+ with λ_em, λ_- with λ_nonEm, μ_+ with μ_em, and μ_- with μ_nonEm.
After solving for the state probability p_n_nonEm, the average waiting time per non-emergent patient image is given by Equation <ref>.



  §.§.§ Model B in with-CADt scenario



When a CADt is included in the workflow, three priority classes exist: emergent (highest priority), AI-positive (middle priority), and AI-negative (lowest priority) classes.
With the presence of emergent patients, the arrival rates of AI-positive and AI-negative classes are now

    λ_+ = [πSe + (1-π)(1-Sp) ](1-f_em)λ, and


    λ_- = [π(1-Se) + (1-π)Sp](1-f_em)λ.

Their reading rates are given by Equations <ref> and <ref>.
However, because μ_D = μ_ND, the reading rates for the AI-positive and AI-negative subgroups are the same; μ_+ = μ_- = μ_D = μ_ND.
Similar to Model A in with-CADt scenario, we apply the RDR method and solve for the AI-positive and AI-negative systems separately.

For the AI-positive subgroup, it is noted that an AI-positive patient image can only be interrupted by emergent patient images and will not be impacted by any AI-negative patient images.
Therefore, the emergent and AI-positive subgroups form a two-priority-class queueing system which can be solved using the framework developed for the non-emergent subgroup in the without-CADt scenario.
Figure <ref> (and Equation <ref> in Electronic Companions) can be reused by replacing λ_+ with λ_em, λ_- with λ_+, μ_+ with μ_em, and μ_- with μ_+.
The state probability p_n_+ for the AI-positive subgroup is calculated, from which the average waiting time per AI-positive patient image is given by Equation <ref>.

The calculation for the AI-negative, lowest-priority subgroup involves states (n_em, n_+, n_-) defined by the number of emergent, AI-positive, and AI-negative patient images in the system.
An AI-negative patient image can be interrupted by either an emergent or an AI-positive patient image.
The arrival time of the interrupting case denotes the start of a busy period, which is defined as the time period during which a radiologist is too busy for AI-negative cases.
While the radiologist is reading the interrupting case, new emergent and/or AI positive images may enter the system, which further delays the review of the interrupted AI-negative case.
Once all the higher-priority images are reviewed, the radiologist then resumes the reading of the interrupted AI-negative patient image, and the busy period ends.



Due to the different arrival and reading rates between the emergent and AI-positive patient images, the dependence of AI-negative busy period on the two subgroups are different.
As <cit.> discussed, one must keep track of the state at which the busy period starts and the state at which the busy period ends.
With only one radiologist, Model B has only two distinct busy periods:

    
  * B_1: (0, 1^+, n_-) → (0, 0, n_-)
    
  * B_2: (1^+, 0, n_-) → (0, 0, n_-)

Here, B_1 and B_2 are the rates of the two busy periods and are explicitly shown as two non-exponential transitions in Figure <ref>.

Just like the AI-negative system in Model A, one must first calculate the first three moments for each busy period and approximate each distribution using a two-phase Coxian distribution.
With three priority classes and two busy periods, the approximation involves the inter-level passage times from the AI-positive transition diagram, from which a transition probability matrix as well as the transition rate matrix are determined (see M_B in Section <ref>).
From transition rate matrix, the state probability p_n_- can be solved via conventional matrix geometric method.
Once p_n_- is determined, the average waiting time per AI-negative patient image W_q_- can be calculated via Equation <ref>.






 §.§ Model C: Model B with two radiologists



Model C extends Model B by adding one extra radiologist on-site N_rad = 2.
The arrival rates for the emergent, non-emergent, AI-positive, and AI-negative classes remain the same (Equations <ref> - <ref>).
Because μ_D = μ_ND, the reading rates for the non-emergent, AI-positive, and AI-negative subgroups are the same; μ_+ = μ_- = μ_nonEm.
Because of the extra radiologist, the traffic intensity ρ has a factor of two; ρ=λ/2μ.
It should be noted that Model C has the same settings as the example in <cit.>.



  §.§.§ Model C in without-CADt scenario





With no CADt devices, the RDR-truncated transition diagram for the non-emergent, lower-priority class is given by Figure <ref>.
Given two radiologists on-site, a non-emergent image can depart the system only when n_em < 2, and hence the truncation of states starts when n_em = 2.
Moreover, when n_em = 0, both radiologists are available for non-emergent patient images.
Thus, the first row has a leaving rate 2μ_nonEm, except the transition from (0, 1) to (0, 0) when only one radiologist has work to do.
When n_em = 1 (the second row), only one of the two radiologists is available to review a non-emergent case, resulting in a leaving rate of 1μ_nonEm.
When n_em≥ 2, both radiologists are busy handling emergent cases.
Since no radiologist is available for non-emergent images, their leaving rate is 0, and no non-emergent images can leave the system.
To approximate the transition rate B in Figure <ref>, the same two-phase Coxian approximation described in Models A and B is applied.

The transition rate matrix M_C_noCADt for Figure <ref> can be found in Section <ref>.
From M_C_noCADt, the state probability p_n_nonEm is determined, and the average waiting time per non-emergent patient image is given by Equation <ref>.



  §.§.§ Model C in with-CADt scenario



In the with-CADt scenario, the calculations for AI-positive (middle-priority) and AI-negative (lowest-priority) subgroups are separated.

The queueing system for the AI-positive subgroup consists of two priority classes: the emergent and AI-positive classes, and the framework developed for the non-emergent subgroup in the without-CADt scenario can be reused.
By replacing λ_nonEm with λ_+ and μ_nonEm with μ_+ in Figure <ref> and Equation <ref>, the state probability for the AI-positive subgroup p_n_+ can be computed.
And the average waiting time per AI-positive patient image W_q_+ is given by Equation <ref>.



The approach to analyze the AI-negative, lowest-priority subgroup is similar to the analysis of the AI-negative cases in Model B.
Recall that a state is defined as (n_em, n_+, n_-) and that a busy period is defined by the time duration in which all the radiologists on-site are too busy for AI-negative patient images.
With two radiologists, a busy period may start from one of the three situations: when there are two emergent cases, when there are one emergent and one AI-positive case, or when there are two AI-positive cases.
On the other hand, the busy period ends when one radiologist is handling either an emergent case or an AI-positive case such that the other radiologist is available for the AI-negative case.
Therefore, instead of two busy periods in Model B, adding one extra radiologist increases the total number of busy periods to six:

    
  * B_1: (0, 2^+, n_-) → (0, 1^+, n_-)
    
  * B_2: (0, 2^+, n_-) → (1^+, 0, n_-)
    
  * B_3: (1^+, 1^+, n_-) → (0, 1^+, n_-)
    
  * B_4: (1^+, 1^+, n_-) → (1^+, 0, n_-)
    
  * B_5: (2^+, 0, n_-) → (0, 1^+, n_-)
    
  * B_6: (2^+, 0, n_-) → (1^+, 0, n_-)


Figure <ref> shows the RDR-truncated transition diagram for AI-negative subgroup.
Note that states (0, 2^+, n_-), (1^+, 1^+, n_-), and (2^+, 0, n_-) are duplicated because their corresponding arrival rates also depends on the probabilities that the busy period ends at a particular state i.e. either (0, 1^+, n_-) or (1^+, 0, n_-). 
For example, p_1 denotes the conditional probability that the busy period ends at (0, 1^+, n_-) given that it starts at (0, 2^+, n_-).

Before solving for Figure <ref>, one must compute the conditional probability and the first three moments of each busy period, from which the transition rates can be approximated.
The calculation is discussed in Section <ref>, where the AI-positive transition diagram for inter-level passage times is presented, and the transition probability matrix is constructed.

Each busy period is approximated using the EC distribution (Figure <ref>).
However, unlike Model B in which two-phase Coxian is sufficient for all busy periods, B_2 and B_5 in Model C require an extra Erlang phase, as shown in Figure <ref>.
With an extra phase, two extra parameters t_0 and t_01 are needed to approximate B_2 and B_5.

    t_0     = (1-p__EC)λ_Y_EC; 
    t_01 = p__ECλ_Y_EC; 
    
    t_1     = (1-p_X_EC)λ_X1_EC;  
    t_12 = p_X_ECλ_X1_EC; 
    t_2 = λ_X2.




Once all six busy periods are approximated, the transition rate matrix for the AI-negative, lowest-priority class can be constructed from Figure <ref>. (See Section <ref>.)
Like before, the corresponding state probability p_n_- can be solved by the matrix geometric method.
And, the average waiting time per AI-negative patient image W_q_- can be calculated via Equation <ref>.

For N_rad≥ 3, the same approach can be applied.
However, as the number of busy periods increases, the transition rate matrix will grow in size drastically, especially when more Erlang phases are required for the busy period approximation.






 §.§ Model D: Model B with different reading rates


Model D extends Model B by differentiating the radiologist's reading rate between the diseased and non-diseased subgroups (N_rad = 1, f_em > 0, and μ_D ≠μ_ND).
The arrival rates for the emergent, non-emergent, AI-positive, and AI-negative classes remain the same (Equations <ref> - <ref>).
However, because μ_D ≠μ_ND, the reading rates for non-emergent, AI-positive, and AI-negative subgroups depend on disease prevalence π, positive predictive value PPV, and negative predictive value NPV (Equations <ref>-<ref>).



  §.§.§ Model D in without-CADt scenario



  

The without-CADt scenario has two priority classes: emergent and non-emergent patient images.
Within the non-emergent class, two groups of patient images (diseased and non-diseased) are reviewed in a first-in-first-out (FIFO) basis.
The corresponding transition diagram is shown in Figure <ref>.
As usual, the state keeps track of n_em and n_nonEm.
In addition, because of the different reading rates between the diseased and non-diseased subgroups, the state must also keep track of the disease status of the image that the radiologist is reviewing.
Therefore, the state is defined as (n_em, n_nonEm, i), where i is either D (i.e. the radiologist is working on a diseased image) or ND (i.e. the radiologist is working on a non-diseased image).
Furthermore, one must pay attention to how the busy period starts and ends.
For example, if the radiologist reading a diseased image is interrupted by the arrival of an emergent image i.e. (0, n, D) → (1^+, n, D), the state must go back to (0, n, D) and not to (0, n, ND) when the busy period is over.
This property is guaranteed by having two sets of truncated states: (1^+, n)_→ D that can only interact with (0, n, D) and (1^+, n)_→ ND that can only interact with (0, n, ND).

The corresponding transition rate matrix of Figure <ref> is given in Section <ref>. 
Note that, although Figure <ref> has two busy periods per column (one for “→ D” and the other for “→ ND”), they both describe the same transition time when at least one emergent image is in the system.
Therefore, only one unique set of t-parameters is calculated to approximate both busy periods.



  §.§.§ Model D in with-CADt scenario



The calculation for AI-positive (middle-priority) and AI-negative (lowest-priority) subgroups are separated. 

Because AI-positive patient images are not impacted by AI-negative cases, the emergent and AI-positive subgroups form a two-priority-class queueing system.
The transition rate matrix M_D_noCADt from Figure <ref> can be reused to analyze the queueing of AI-positive patient images.
By replacing λ_nonEm by λ_+ (Equation <ref>), μ_nonEm by μ_+ (Equation <ref>), and π by PPV, the state probability for the AI-positive subgroup p_n_+ is calculated via standard matrix geometric method.
The average waiting time per AI-positive patient image W_q_+ is then given by Equation <ref>.

  

For the AI-negative, lowest-priority class, the full definition of state (n_em, n_+, i, n_-, j).
i is either D or ND, indicating whether the radiologist is working on a diseased, AI-positive case or a non-diseased, AI-positive case respectively.
The disease status of an AI-negative case that the radiologist is reading is represented by the j which is either D or ND.
Because we only have one radiologist, i and j cannot appear simultaneously; the one radiologist can only handle an AI-positive or AI-negative case but not both at the same time.

Figure <ref> shows the RDR-truncated transition diagram for the AI-negative subgroup.
There are three unique busy periods with the corresponding transition rates B_i:

    
  * B_1: (1^+, 0, n_-) → (0, 0, n_-, j)
    
  * B_2: (0, 1^+, D, n_-) → (0, 0, n_-, j)
    
  * B_3: (0, 1^+, ND, n_-) → (0, 0, n_-, j)

For each busy period, the truncated state is duplicated with either “→ D" or “→ ND" such that the system can return to the state with the correct disease status j when the busy period is over.

Like before, for each unique busy period, its conditional probability and first three moments are determined from the transition probability matrix (see Section <ref>).
And, each unique busy period has a set of t-parameters (Equation <ref>) approximated from a two-phase Coxian distribution.
With the approximated busy period transitions, a transition rate matrix can be constructed for the AI-negative subgroup from Figure <ref> (see Section <ref>).
The state probability p_n_- is then solved, and the average waiting time per AI-negative patient image W_q_- can be calculated via Equation <ref>.






§ SIMULATION



To verify the analytical results from our theoretical queueing approach, a Monte Carlo software was developed using Python to simulate the flow of patient images in a clinic with and without a CADt device.
A workflow model is defined by a set of input parameters {f_em, π, ρ, μ, N_rad, Se, and Sp}.

During the simulation, a new patient image entry is randomly generated with a timestamp that follows a Poisson distribution at an overall arrival rate of λ, which is computed from the user-inputs (traffic ρ and radiologist's reading rates μ).
Each patient image is randomly assigned with an emergency status (emergent or non-emergent) based on the input emergency fraction f_em.
If the patient image is emergent, a reading time is randomly generated from an exponential distribution with a reading rate of μ_em.
If the patient image is non-emergent, a disease status (diseased or non-diseased) is randomly assigned based on the input disease prevalence π.
The reading time for this non-emergent patient image is also randomly drawn from an exponential distribution with a reading rate of either μ_D if it is diseased or μ_ND if it is non-diseased.
Each non-emergent patient image is also assigned with an AI-call status (positive or negative) based on its disease status and the input AI accuracy (Se and Sp).
The patient image is then simultaneously placed into two worlds: one with a CADt device and one without.

In a without-CADt world, the incoming patient image is either a higher-priority case (if it is emergent) or a lower-priority case (if non-emergent).
If the patient image is emergent, the case is prioritized over all non-emergent patient images in the system and is placed at the end of the emergent-only queue.
Otherwise, the patient image is non-emergent and is placed at the end of the current reading queue.
In time, when its turn comes, this patient image is read by one of the radiologists and is then removed from the queue.
Two pieces of information are recorded for this simulated patient image.
One is its waiting time defined as the difference between the time when the image enters the queue and when it leaves the queue.
In addition, the number of emergent and non-emergent patient images in the queue right before the arrival of the new patient image are also recorded to study the state probability distribution.

Alternatively, this very same patient image is placed in the with-CADt world.
This image has either a high priority (if emergent), a middle priority (if AI-positive), or a low priority (if AI-negative).
If the patient image is emergent, the case is prioritized over all AI-positive and AI-negative patient images in the system and is placed at the end of the emergent-only queue.
If the patient image is AI-positive, the case is prioritized over all AI-negative images and is placed at the end of the queue consisting of only emergent and AI-positive patient images.
Otherwise, the patient image is AI-negative and is placed at the end of the current reading queue.
The reading time for this patient image in the with-CADt world is identical to its reading time in the without-CADt world.
However, due to the re-ordering by the CADt device, its waiting time in the with-CADt world may be different from that in the without-CADt world.
For every patient image, the difference between the two waiting times in the two worlds can be calculated to determine whether the use of the CADt device results in a time-saving or time delay for this image.
In addition to its waiting time, the number of emergent, AI-positive, and AI-negative patient images right before the arrival of the new patient image are also recorded.

To simulate a big enough sample size, a full simulation includes 200 simulations, each of which contains roughly 2,000 patients.
From all simulations, the waiting times from all diseased patient images are histogrammed from which the mean value and the 95% confidence intervals are determined.







§ TIME-SAVING EFFECTIVENESS EVALUATION METRIC



We define a metric to quantitatively assess the time-saving effectiveness of a given CADt device.
Both theoretical and simulation approaches output the mean waiting time per diseased patient image W_D in both with- and without-CADt scenarios.

Without a CADt device, since the arrival process is random, the average waiting time per non-emergent patient image W^no-CADt_nonEm is the same as W^no-CADt_D i.e. 

    W^no-CADt_D = W^no-CADt_nonEm = W_q_nonEm.

When a CADt device is included in the workflow, the average waiting time per diseased and non-diseased patient images are no longer the same because the diseased images are more likely to be prioritized by the CADt. 
To calculate W^CADt_D, we first compute the average waiting time per AI-positive (W^CADt_+ = W_q_+) and per AI-negative (W^CADt_- = W_q_-) patient image based on the mathematical frameworks discussed in Section <ref>.
By definition, the average waiting time for the diseased subgroup W^CADt_D is 

    W^CADt_D≡Total waiting time from all diseased patient images/Number of diseased patient images.

Note that the total waiting time from all diseased patients is the sum of the total waiting time from the true-positive (TP) subgroup and that from the false-negative (FN) subgroup.
Let N_TP, N_FN, and N_D be the number of TP patient images, that of FN patient images, and that of diseased images.
W^CADt_D can be rewritten as

    W^CADt_D = W^CADt_+× N_TP + W^CADt_-× N_FN/N_D.

Because N_TP/N_D and N_FN/N_D are, by definition, Se and 1-Se, we have

    W^CADt_D = W^CADt_+×Se + W^CADt_-× (1-Se).
    

To quantify the time-saving effectiveness of a CADt device for diseased patient images, we define a time performance metric δ W_D as the difference in mean waiting time per diseased image in the with-CADt and that in the without-CADt scenario:

    δ W_D≡ W^CADt_D - W^no-CADt_D.

It should be noted that, besides the explicit dependence on AI sensitivity in Equation <ref>, δ W_D also depends on AI specificity and all the clinical factors in the calculation of W^CADt_+, W^CADt_-, and W^no-CADt_nonEm.

Based on its definition, a negative δ W_D implies that, on average, a diseased patient image is reviewed earlier when the CADt device is included in the workflow than when it is not.
The more negative δ W_D is, the more time is saved, and the more effective the CADt device is.
If δ W_D = 0, the presence of CADt device does not bring any benefit for the diseased patient images.
If δ W_D is positive, the review of a diseased patient image is delayed on average, and the CADt device brings more risks than benefits to the diseased subgroup.

It should also be noted that the amount of time savings for other subgroups can be defined similarly.
For example, for the non-diseased subgroup, the average waiting time per non-diseased patient image in the without-CADt scenario, W^no-CADt_ND, is 

    W^no-CADt_ND = W^no-CADt_nonEm.

When the CADt device is included in the workflow, the average waiting time per non-diseased patient image, W^CADt_ND, becomes 

    W^CADt_ND = W^CADt_+× (1-Sp) + W^CADt_-×Sp,

where the first and second terms correspond to the false-positive and true-negative subgroups respectively.
δ W_ND can then be defined to describe the average wait-time difference between the with-CADt and without-CADt scenarios for the non-diseased subgroup.






§ RESULTS AND DISCUSSION



Top plot in Figure <ref> shows the time saved per diseased patient images as a function of traffic intensity ρ for one and two radiologists on-site without any emergent patient images.
Assuming a disease prevalence π of 10%, an AI sensitivity of 95%, a specificity of 89%, an average image reading time of 10 minutes for both diseased and non-diseased subgroups, and one radiologist on-site, the time saving is significantly improved from about 2 minutes in a quiet, low-volume clinic (radiology traffic intensity of 0.3) to about an hour in a relatively busy clinic (radiology traffic intensity of 0.8).
At a traffic intensity ρ of 0.8, the impact due to disease prevalence is found to be small (see middle plot in Figure <ref>).
Overall, the time-saving effectiveness of the device is also found to be more evident with only one radiologist on-site compared to two.
Bottom plot in Figure <ref> shows the impact on the time-saving effectiveness due to the presence of emergent patient images with the highest priority that overrides any AI prioritization.
The amount of time saved per diseased image without any emergent patients (f_em = 0) is more-or-less the same as that with f_em = 50%.
This is likely because the amount of delay caused by emergent patient images in a without-CADt scenario is similar to that in the with-CADt scenario.

  

  

The effect of having different radiologist's reading rates for diseased and non-diseased subgroups are shown in Figure <ref>.
The overall dependence on traffic intensity, disease prevalence, and emergency fraction is similar to that in Figure <ref>.
However, more time is saved for diseased patient images when μ_D < μ_ND i.e. when a radiologist takes more time on average to read a non-diseased image than a diseased image.

For the purpose of evaluating a CADt device, we propose a summary plot as shown in Figure <ref> based on Model B, describing both the diagnostic and time-saving effectiveness of a CADt device.
This plot is built upon a traditional receiver operating characteristic (ROC) analysis <cit.>, in which the ROC curve characterizes the diagnostic performance of the CADt device.
For a given radiologist workflow defined by a set of parameters, every point of False-Positive Rate (FPR) and True-Positive Rate (TPR) in the ROC space has an expected mean time savings per diseased patient image, δ W_D, which is presented by the color map.
The device diagnostic performance is near ideal in the top left corner of the ROC space, where δ W_D is the most negative.

  

To show the time-saving effectiveness of a CADt device, δ W_D along the ROC curve is plotted as a function of FPR (top) and TPR (left).
At (FPR, TPR) = (0, 0), δ W_D is 0 minute because all images are classified as AI-negative i.e. no images are prioritized.
As both FPR and TPR increase along the ROC curve, the amount of time savings |δ W_D| increases since most AI-positive cases are truly diseased patient images.
As FPR and TPR continue to increase, the number of false-positive cases becomes dominant, reducing the device’s time-saving effectiveness.
When (FPR, TPR) = (1, 1), δ W_D goes back to 0 because all images are classified as AI-positive, and the system essentially has no priority classes. 

The mean time-savings for diseased patient images δ W_D can be directly linked to potential patient outcome.
For example, if our disease of interest is large vessel occlusion (LVO) stroke, δ W_D color axis on the right side of Figure <ref> can be translated to three stroke patient outcome metrics.
According to Table 12 in Supplementary Content (Supplementary 2) of <cit.>, for every 15 minutes sooner that a patient is treated, 3.9% of stroke patients resulted in less disability.
This can be translated to the two other common LVO stroke patient outcome metrics - the number of patients needed to treat for benefit (NNTB) and the number of minutes faster needed to treat (MNT).
The relationships between δ W_D and LVO stroke patient outcome metrics are extrapolated linearly and shown in the three axes on the right side of Figure <ref>.
As a result, the optimal δ W_D along the ROC curve is roughly -40 minutes, which corresponds to approximately 11% increase in LVO stroke patients with less disability, more than 9 NNTB, and more than 1.4 MNT.  Remember that these results depend on our assumed reading rates and traffic intensity.  In the future we expect to gather clinical data to make more accurate estimates of reading rates, traffic intensity, and wait-time savings.

Based on our queueing approach, the time-saving effectiveness of a CADt device depends largely on the clinical settings.
Our model suggests that CADt devices with a typical AI diagnostic performance (95% sensitivity and 89% specificity) are most effective in a busy, short-staffed clinic.
All theoretical predictions agree with simulation results well within the 95% confidence intervals.
All software used in making the theoretical calculations and the simulations in this paper will be made available on the Github site for the FDA's Division of Imaging, Diagnostics, and Software Reliability, https://github.com/DIDSR/QuCAD.

In this work where only one disease is considered, the CADt device is trained to identify the disease, and a patient image can either be diseased or non-diseased.
Under this consideration, when evaluating the time-saving effectiveness of the CADt, δ W_D is used as the performance metric because the CADt device is intended to benefit diseased patients with time critical conditions.
In the future, when we expand our work to a reading queue that consists of patient images with two or more diseases, a new performance matric will be defined to take into account other time-critical diseases that the CADt does not look for.






§ CONCLUSION



We present a mathematical framework based on queueing theory and the Recursive Dimensionality Reduction method to quantify the time-saving effectiveness of an AI-based medical device that prioritizes patient images based on its binary classification outputs.
Several models are developed to theoretically predict the wait-time-saving effectiveness of such a device as a function of various parameters, including disease prevalence, patient arrival rate, radiologist reading rate, number of radiologists on-site, AI sensitivity and specificity, as well as the presence of emergent patient images with the highest priority that overrides any AI prioritization.
The methodology proposed in this paper helps evaluate the time-saving performance of a CADt or any prioritization device.
The models presented here could also be used to evaluate discrimination algorithms in many other queueing contexts, such as serving customers or computer job queueing.
In the near future, we plan on expanding our model to clinical scenarios of multiple disease conditions, modalities, and anatomies with several CADt devices being used simultaneously.






§ ACKNOWLEDGMENTS


The authors would like to thank Dr. Mor Harchol-Balter (harchol@cs.cmu.edu) and Dr. Takayuki Osogami (OSOGAMI@jp.ibm.com) for helping us understand their Recursive Dimensionality Reduction (RDR) method for complex queueing systems. In addition, the authors acknowledge funding from the Critical Path Program of the Center for Devices and Radiological Health. The authors also acknowledge funding by appointments to the Research Participation Program at the Center for Devices and Radiological Health administered by the Oak Ridge Institute for Science and Education through an interagency agreement between the U.S. Department of Energy and the U.S. Food and Drug Administration (FDA).







§ MARKOV CHAIN MATRICES

This appendix section provides the matrices involved for each of the four radiologist workflow models discussed in Section <ref>. 



 §.§ Model A in with-CADt scenario



Markov chain transition rate matrix M_A is built upon Figure <ref>. 


    M_A = 
     [
        [ B_00 B_01               ; B_10  A_1  A_2     ;       A_0  A_1  A_2;            A_0  A_1    ⋱;                   ⋱    ⋱;      ]],

where 

    A_0    = [ μ_-   0   0;   0   0   0;   0   0   0 ], 
     A_1 = [    *  λ_+    0;  t_1    * t_12;  t_2    0    * ], 
    
    
     A_2    =  [ λ_-   0   0;   0 λ_-   0;   0   0 λ_- ], 
    
    
     B_01   = [ λ_-   0   0;   0 λ_-   0;   0   0 λ_- ], 
     B_00 = [    *  λ_+    0;  t_1    * t_12;  t_2    0    * ], 
    
    
     B_10   =  [ μ_-   0   0;   0   0   0;   0   0   0 ].


M_A had a tri-diagonal block structure defined by sub-matrices As and Bs, in which *'s are the negative of the sum of all elements in the corresponding row.
B_00, B_01, and B_10 are block matrices representing the boundary condition at the state of n_- = 0; states with n_- < 0 are forbidden because the reading queue cannot have a negative number for AI-negative patient images.
A_0, A_1, and A_2 are repetitive block structures that iterate along the diagonal axis of the matrix.



 §.§ Model B in with-CADt scenario



This scenario has two busy periods (B_1 and B_2).
For each busy period, we first calculate its first three moments of the inter-level passage times using Figure <ref>.
The states at which the two AI-negative busy periods start and end are highlighted.
For instance, B_1 is the time period starting from (0, 1) in red and ending at (0, 0) in blue, regardless of any intermediate states that the system may go through.
The steps involved to calculate the first three moments are documented in Appendix A of <cit.>.



Based on Figure <ref>, the transition probability matrix P_B is given below.

    P_B = 
     [
        [ ℒ_1 ℱ_1        ; ℬ_2 ℒ_2 ℱ_2    ;     ℬ_3 ℒ_3 ℱ_3    ;         ℬ_4 ℒ_4   ⋱;               ⋱   ⋱;     ]],

where 

    ℬ_ℓ=2   = [ μ_+/λ_em+λ_++μ_+; t_1/λ_++t_1+t_12;      t_2/λ_++t_2;                  ], 
    
    ℬ_ℓ≥ 3   = [ μ_+/λ_em+λ_++μ_+                0                0; t_1/λ_++t_1+t_12                0                0;      t_2/λ_++t_2                0                0;                  ], 
    
    ℒ_ℓ=1   = [ 0 ], ℒ_ℓ≥ 2 = [                 0                 0                 0;                 0                 0 t_12/λ_++t_1+t_12;                 0                 0                 0;                   ], 
     
    
    ℱ_ℓ=1   = [  λ_+/λ_+ + λ_em λ_em/λ_+ + λ_em               0 ], 
     
    
    ℱ_ℓ≥ 2   = [  λ_+/λ_+ + λ_em+μ_+ λ_em/λ_+ + λ_em+μ_+                   0;                   0   λ_+/λ_+ +t_1+t_12                   0;                   0                   0        λ_+/λ_+ +t_2;                     ].

Here, the t-parameters are the approximated exponential rates from the transition B in Figure <ref>.
With ℱ, ℒ, and ℬ, <cit.> provide the framework to obtain the G matrix, which contains the probabilities of the busy periods involved, and the Z_r matrices, which have the r-th moments of the busy periods.
For the AI-negative priority class in Model B, the Z_r matrix has a dimension of 3×1, where the first and second elements are the r-th moments of B_1 and B_2 respectively.
For each of the two busy periods, a two-phase Coxian distribution can be used to approximate the distribution shape using Equation <ref>.

Let t^(1)_1, t^(1)_12, and t^(1)_2 be the approximated rates for B_1, and t^(2)_1, t^(2)_12, and t^(2)_2 be the approximated rates for B_2.
The transition rate matrix M_B for Figure <ref> is given below.

    M_B = 
     [
        [ B_00 B_01     ; B_10  A_1  A_2     ;       A_0  A_1    ⋱;            A_0    ⋱;                   ⋱;      ]],

where 

    A_0    = [ μ_-   0   0   0   0;   0   0   0   0   0;   0   0   0   0   0;   0   0   0   0   0 ], 
     
    
    
     A_1    = [        *      λ_+        0     λ_em        0;  t^(1)_1        * t^(1)_12        0        0;  t^(1)_2        0        *        0        0;  t^(2)_1        0        0        * t^(2)_12;  t^(2)_2        0        0        0        *;          ],
    
    
    
     A_2    = [ λ_-   0   0   0   0;   0 λ_-   0   0   0;   0   0 λ_-   0   0;   0   0   0 λ_-   0;   0   0   0   0 λ_-;     ], 
    
    
     B_00   = [        *      λ_+        0     λ_em        0;  t^(1)_1        * t^(1)_12        0        0;  t^(1)_2        0        *        0        0;  t^(2)_1        0        0        * t^(2)_12;  t^(2)_2        0        0        0        *;          ], 
    
    
     B_01   = [ λ_-   0   0   0   0;   0 λ_-   0   0   0;   0   0 λ_-   0   0;   0   0   0 λ_-   0;   0   0   0   0 λ_-;     ], 
    
    
     B_10   = [ μ_-   0   0   0   0;   0   0   0   0   0;   0   0   0   0   0;   0   0   0   0   0 ].


The sub-matrices in M_B are very similar to that in M_A (Equations <ref> and <ref>).
The one difference is that these sub-matrices are now 5×5 instead of 3×3 due to the extra row of truncated states in Figure <ref> compared to Figure <ref>.



 §.§ Model C in without-CADt scenario



The transition rate matrix M_C_noCADt is built upon Figure <ref>.

    M_C_noCADt = 
     [
        [ B_00 B_01               ; B_10  A_1  A_2     ;       A_0  A_1  A_2     ;            A_0  A_1    ⋱;                   ⋱    ⋱;      ]],

where 

    A_0    = [ 2μ_nonEm        0        0        0;        0  μ_nonEm        0        0;        0        0        0        0;        0        0        0        0 ], 
    
    
     A_1    = [    * λ_em    0    0; μ_em    * λ_em    0;    0  t_1    * t_12;    0  t_2    0    * ], 
    
    
     A_2    = [ λ_nonEm       0       0       0;       0 λ_nonEm       0       0;       0       0 λ_nonEm       0;       0       0       0 λ_nonEm ],



    B_00   = 0.7[     [cccc:cccc]
          *                    λ_em                       0                       0                 λ_nonEm                       0                       0                       0;                     μ_+                       *                    λ_em                       0                       0                 λ_nonEm                       0                       0;                       0                     t_1                       *                    t_12                       0                       0                 λ_nonEm                       0;                       0                     t_2                       0                       *                       0                       0                       0                 λ_nonEm; [2pt/2pt]
          μ_nonEm                       0                       0                       0                       *                    λ_em                       0                       0;                       0                 μ_nonEm                       0                       0                       μ                       *                    λ_em                       0;                       0                       0                       0                       0                       0                     t_1                       *                    t_12;                       0                       0                       0                       0                       0                     t_2                       0                       *;                         ], 
    
    
     B_01   =  0.8[                       0                       0                       0                       0;                       0                       0                       0                       0;                       0                       0                       0                       0;                       0                       0                       0                       0; [2pt/2pt]
          λ_nonEm                       0                       0                       0;                       0                 λ_nonEm                       0                       0;                       0                       0                 λ_nonEm                       0;                       0                       0                       0                 λ_nonEm;                         ], 
    
    
     B_10   =   1[ [cccc:cccc]
         0                  0                  0                  0           2μ_nonEm                  0                  0                  0;                  0                  0                  0                  0                  0            μ_nonEm                  0                  0;                  0                  0                  0                  0                  0                  0                  0                  0;                  0                  0                  0                  0                  0                  0                  0                  0 ].




 §.§ Model C in with-CADt scenario





This scenario has six busy periods (B_1 to B_6).
For each busy period, we first calculate its conditional probability and the first three moments of the inter-level passage times using Figure <ref>.
And the corresponding transition probability matrix P_C is given below.


    P_C = 
     [
        [ ℒ_1 ℱ_1        ; ℬ_2 ℒ_2 ℱ_2    ;     ℬ_3 ℒ_3 ℱ_3    ;         ℬ_4 ℒ_4   ⋱;               ⋱   ⋱;     ]],

where 

    ℬ_ℓ=2   = 1[   μ_+/λ_em+λ_++μ_+; μ_em/λ_em+λ_++μ_em ] , 
    
    ℬ_ℓ=3   = 1[     2μ_+/λ_em+λ_++2μ_+                      0; μ_em/λ_em+λ_++μ_++μ_em  μ_+/λ_em+λ_++μ_++μ_em;                      0       t_1/λ_++t_1+t_12;                      0            t_2/λ_++t_2;                        ]
    
    ℬ_ℓ≥4   = 1[     2μ_+/λ_em+λ_++2μ_+                      0                      0                      0; μ_em/λ_em+λ_++μ_++μ_em  μ_+/λ_em+λ_++μ_++μ_em                      0                      0;                      0       t_1/λ_++t_1+t_12                      0                      0;                      0            t_2/λ_++t_2                      0                      0;                        ],
        
    
    ℒ_ℓ=1   = [ 0 ], ℒ_ℓ=2 = [ 0 0; 0 0 ], 
    
    ℒ_ℓ≥3   = [                 0                 0                 0                 0;                 0                 0                 0                 0;                 0                 0                 0 t_12/λ_++t_1+t_12;                 0                 0                 0                 0 ],
        
    
    ℱ_ℓ=1   = 1[  λ_+/λ_em+λ_+ λ_em/λ_em+λ_+ ], 
    
    ℱ_ℓ=2   = 1[   λ_+/λ_em+λ_++μ_+  λ_em/λ_em+λ_++μ_+                  0                  0;                  0  λ_+/λ_em+λ_++μ_em λ_em/λ_em+λ_++μ_em                  0 ],
        
    
    ℱ_ℓ≥3    = 0.8[      λ_+/λ_em+λ_++2μ_+     λ_em/λ_em+λ_++2μ_+                      0                      0;                      0  λ_+/λ_em+λ_++μ_++μ_em λ_em/λ_em+λ_++μ_++μ_em                      0;                      0                      0       λ_+/λ_++t_1+t_12                      0;                      0                      0                      0            λ_+/λ_++t_2 ].


With P_C, the conditional probabilities and first three moments of inter-level passage times for all six busy periods are computed according to Appendix A of <cit.>.
For most busy periods, three t-parameters are sufficient for the approximation.
However, for B_2 and B_5, due to the two extra Erlang phases, two additional parameters t_0 and t_01 are required.

Let t^(i)_j denote the t_j-parameter for a busy period B_i.
The transition rate matrix M_C_CADt for the AI-negative, lowest-priority class from Figure <ref> is given by

    M_C_CADt = 
     [
        [ B_00 B_01          ; B_10  A_1  A_2     ;       A_0  A_1    ⋱;            A_0    ⋱;                   ⋱;      ]].

All A sub-matrices are 17×17. 
Here, 0_14 denotes a 14×14 zero matrix, and 𝕀_17 is a 17×17 identity matrix.


    A_0    = [ 2μ_-          ;       μ_-     ;            μ_-     ;                0_14 ], 
    
    
     A_2    = λ_- 𝕀_17, 
    
    
     A_1   = 0.75[ [ccc:c:c:c:c:c:c]
            *                         λ_+                        λ_em                                                                                                                                                                        ;                         μ_+                           *                                                  𝐩_1λ_+                      𝐩_2λ_+                     𝐩_3λ_em                     𝐩_4λ_em                                                        ;                        μ_em                                                       *                                                                              𝐩_3λ_+                      𝐩_4λ_+                     𝐩_5λ_em                     𝐩_6λ_em;                   [2pt/2pt]                       𝐭^(1)                                                 𝕋^(1)_4                                                                                                                                            ;                   [2pt/2pt]                                                   𝐭^(2)                                                 𝕋^(2)_5                                                                                                                ;                   [2pt/2pt]                       𝐭^(3)                                                                                                         𝕋^(3)_6                                                        ;                   [2pt/2pt]                                                   𝐭^(4)                                                                                                         𝕋^(4)_7                                                        ;                   [2pt/2pt]                       𝐭^(5)                                                                                                                                                                 𝕋^(5)_8;                   [2pt/2pt]                                                   𝐭^(6)                                                                                                                                                                 𝕋^(6)_9 ],
 
where, for i = 1, 3, 4, 6,

    𝐩_𝐢 = [ p_i   0 ], 𝐭^(i) = [ t_1^(i); t_2^(i) ],  𝕋^(i)_k = [        * t_12^(i);                 * ].

For i = 2, 5, because of the extra Erlang phase, the sub-matrices have an extra row and/or column.

    𝐩_𝐢 = [ p_i   0   0 ], 𝐭^(i) = [ t_0^(i); t_1^(i); t_2^(i) ],  𝕋^(i)_k = [        * t_01^(i)         ;                 * t_12^(i);                          * ].

Similarly, the boundary B sub-matrices are given below.

    B_01   = [                    0_17; [2pt/2pt]
         λ_- 𝕀_17 ], 
     B_10 = [                                           [c:c]
        0_17 2μ_+          
       μ_+       
          μ_+    
             0_14 ], 
    
    
     B_00   = [                                                          [c:c]
        A_1                                                               λ_- 𝕀_17; [2pt/2pt]
         μ_+          
       μ_+       
          μ_+    
             0_14                                                                    A_1 ].




 §.§ Model D in without-CADt scenario



The transition rate matrix M_D_noCADt for Figure <ref> is given below. 

    M_D_noCADt = 
     [
        [ B_00 B_01               ; B_10  A_1  A_2     ;       A_0  A_1  A_2;            A_0  A_1    ⋱;                   ⋱    ⋱;      ]],

where 

    A_0    = [      πμ_D  (1-π)μ_D         0         0         0         0;     πμ_ND (1-π)μ_ND         0         0         0         0;         0         0         0         0         0         0;         0         0         0         0         0         0;         0         0         0         0         0         0;         0         0         0         0         0         0 ], 
    
    
     A_1    = [    *    0 λ_em    0    0    0;    0    *    0    0 λ_em    0;  t_1    0    * t_12    0    0;  t_2    0    0    *    0    0;    0  t_1    0    0    * t_12;    0  t_2    0    0    0    *;      ], 
    
    
     A_2    = λ_nonEm𝕀_6, 
    
    
     B_00   = [    * λ_em    0;  t_1    * t_12;  t_2    0    * ], 
     B_10 = [  μ_D    0    0; μ_ND    0    0;    0    0    0;    0    0    0;    0    0    0;    0    0    0 ], 
    
    
     B_01   = 0.75[     πλ_nE (1-π)λ_nE         0         0         0         0;         0         0     πλ_nE         0 (1-π)λ_nE         0;         0         0         0     πλ_nE         0 (1-π)λ_nE ],

where λ_nE refers to the arrival rate of non-emergent subgroup. Note that both M_D_noCADt and M_A (Equation <ref>) describe a queueing system with two priority classes and one radiologist.
However, because μ_D ≠μ_ND, the size of A sub-matrices grow from 3×3 to 6×6 due to the extra i in the state definition and the extra set of truncated states to keep track of disease status of the interrupted case.



 §.§ Model D in with-CADt scenario



This scenario has three busy periods (B_1 to B_3).
For each busy period, we calculate its conditional probability and the first three moments of the inter-level passage times using Figure <ref> and the corresponding transition probability matrix P_D.

  


    P_E = 
     [
        [ ℒ_1 ℱ_1        ; ℬ_2 ℒ_2 ℱ_2    ;     ℬ_3 ℒ_3 ℱ_3    ;         ℬ_4 ℒ_4   ⋱;               ⋱   ⋱;     ]],

where 

    ℬ_ℓ=2   = 1[   μ_D/λ_em+λ_++μ_D; μ_ND/λ_em+λ_++μ_ND;   t_1/λ_++t_1+t_12;        t_2/λ_++t_2 ] , 
    
    ℬ_ℓ=3   = 1[       PPVμ_D/λ_em+λ_++μ_D   (1-PPV)μ_D/λ_em+λ_++μ_D                         0                         0;     PPVμ_ND/λ_em+λ_++μ_ND (1-PPV)μ_ND/λ_em+λ_++μ_ND                         0                         0;          t_1/λ_++t_1+t_12                         0                         0                         0;               t_2/λ_++t_2                         0                         0                         0;                         0          t_1/λ_++t_1+t_12                         0                         0;                         0               t_2/λ_++t_2                         0                         0 ]
    
    ℬ_ℓ≥4   = 1[       PPVμ_D/λ_em+λ_++μ_D   (1-PPV)μ_D/λ_em+λ_++μ_D                         0                         0                         0                         0;     PPVμ_ND/λ_em+λ_++μ_ND (1-PPV)μ_ND/λ_em+λ_++μ_ND                         0                         0                         0                         0;          t_1/λ_++t_1+t_12                         0                         0                         0                         0                         0;               t_2/λ_++t_2                         0                         0                         0                         0                         0;                         0          t_1/λ_++t_1+t_12                         0                         0                         0                         0;                         0               t_2/λ_++t_2                         0                         0                         0                         0;                           ],
        
    
    ℒ_ℓ=1   = 1[ 0 ], ℒ_ℓ=2 = 1[ 0 0 0 0; 0 0 0 0; 0 0 0 0; 0 0 0 0 ], 
    
    ℒ_ℓ≥3   = 1[                 0                 0                 0                 0                 0                 0;                 0                 0                 0                 0                 0                 0;                 0                 0                 0 t_12/λ_++t_1+t_12                 0                 0;                 0                 0                 0                 0                 0                 0;                 0                 0                 0                 0                 0 t_12/λ_++t_1+t_12;                 0                 0                 0                 0                 0                 0;                   ],
        
    
    ℱ_ℓ=1   = 1[     PPVλ_+/λ_em+λ_+ (1-PPV)λ_+/λ_em+λ_+       λ_em/λ_em+λ_+                   0 ],




    ℱ_ℓ=2   = 1[        λ_+/λ_em+λ_++μ_D                       0       λ_em/λ_em+λ_++μ_D                       0                       0                       0;                       0       λ_+/λ_em+λ_++μ_ND                       0                       0      λ_em/λ_em+λ_++μ_ND                       0;                       0                       0     PPVλ_+/λ_++t_1+t_12                       0 (1-PPV)λ_+/λ_++t_1+t_12                       0;                       0                       0                       0          PPVλ_+/λ_++t_2                       0      (1-PPV)λ_+/λ_++t_2 ],
        
    
    ℱ_ℓ≥3    = 1[   λ_+/λ_em+λ_++μ_D                  0  λ_em/λ_em+λ_++μ_D                  0                  0                  0;                  0  λ_+/λ_em+λ_++μ_ND                  0                  0 λ_em/λ_em+λ_++μ_ND                  0;                  0                  0   λ_+/λ_++t_1+t_12                  0                  0                  0;                  0                  0                  0        λ_+/λ_++t_2                  0                  0;                  0                  0                  0                  0   λ_+/λ_++t_1+t_12                  0;                  0                  0                  0                  0                  0        λ_+/λ_++t_2 ].


Each of the three busy periods has a set of t-parameters (Equation <ref>) approximated from a two-phase Coxian distribution.

Let t^(i)_j denote the t_j parameter for the busy period B_i.
The transition rate matrix M_D_CADt for the AI-negative subgroup (Figure <ref>) is given by

    M_D_CADt = 
     [
        [ B_00 B_01          ; B_10  A_1  A_2     ;       A_0  A_1    ⋱;            A_0    ⋱;                   ⋱;      ]]

The 14×14 A sub-matrices are defined below, where 0_12 denotes a 12×12 zero matrix, and 𝕀_14 is a 14×14 identity matrix.


    A_0    = 1[  (1-NPV)μ_D      NPVμ_D            ; (1-NPV)μ_ND     NPVμ_ND            ;                                0_12 ], 
    
    
     A_2    = λ_- 𝕀_14,



    A_1   = 0.85[ [cc:c:c:c:c:c:c]
            *                                                 𝐩λ_em                                               𝐩PPVλ_+                                           𝐩(1-PPV)λ_+                           ;                                                     *                                                 𝐩λ_em                                               𝐩PPVλ_+                                           𝐩(1-PPV)λ_+;    [2pt/2pt]
            𝐭^(1)                                               𝕋^(1)_3                                                                                                                                       ;                  [2pt/2pt]                      𝐭^(1)                                               𝕋^(1)_4                                                                                                            ;    [2pt/2pt]
            𝐭^(2)                                                                                                     𝕋^(2)_5                                                      ;                  [2pt/2pt]                      𝐭^(2)                                                                                                     𝕋^(2)_6                                                      ;    [2pt/2pt]
            𝐭^(3)                                                                                                                                                           𝕋^(3)_7;                  [2pt/2pt]                      𝐭^(3)                                                                                                                                                           𝕋^(3)_8 ],



where, for a busy period B_i,

    𝐩 = [ 1 0 ], 𝐭^(i) = [ t_1^(i); t_2^(i) ],  𝕋^(i)_k = [        * t_12^(i);        0        * ].


 
 
 
 
 

The boundary B matrices, on the other hand, are


    B_00   = 1[  [c:c:c:c]
        -σ_1               𝐩λ_em             𝐩PPVλ_+         𝐩(1-PPV)λ_+; [2pt/2pt]
        𝐭^(1)             𝕋^(1)_2                                        ; [2pt/2pt]
        𝐭^(2)                                 𝕋^(2)_3                    ; [2pt/2pt]
        𝐭^(3)                                                     𝕋^(3)_4;                     ], 
    
    
     B_01   = 1[ [cc:c:c:c]
        (1-NPV)λ_-                    NPVλ_-                                                                              ;                 [2pt/2pt]                                                   ℚ                                                    ;                 [2pt/2pt]                                                                             ℚ                          ;                 [2pt/2pt]                                                                                                       ℚ ], 
    
    
     B_10   = 1[    μ_D       ;   μ_ND       ;        0_12×6 ],


where 


    ℚ = 0.9[ (1-NPV)λ_-          0     NPVλ_-          0;          0 (1-NPV)λ_-          0     NPVλ_- ].




